<div class="row">
	<div class="col-md-12">
		
		
		<ol class="breadcrumb bg-col2">
			<li class="" title="List basedirs">
				<a href="/filebrowser" data-ajaxtarget="#main" class="ajax-link">root</a>
			</li>
			{% for idx,item in breadcrumb %}
			{# add hash of the next item and add a scroll link #}
			{# TODO: correction of scrollposition due to sticky header #}
			{% set deeplink = (breadcrumb[idx+1].hash) ? '#d'~breadcrumb[idx+1].hash : '' %}
			{# TODO append deeplink-hash to href as soon as javascript:setGetParameter() is able to handle hashes #}
				<li class="" title="{{ item.name }}">
					<a href="/filebrowser{{ item.fullpath }}" data-ajaxtarget="#main" class="ajax-link">{{ item.name }}</a>
				</li>
			{% endfor %}
			<li class="small">
				({{ subDirectories|length }} <i class="fa fa-folder-open fa-lg"></i> , {{ files|length }} files)
			</li>
			<li>
				<button role="control" title="add this directory to playlist" class="btn btn-default player-ctrl" data-player='{"action":"addDirToPlaylist", "mpdurl":"/mpdctrl/addSelect/{{ directory~item.name|url_encode }}"}'>
					<i class="fa fa-plus"></i> Add directory to playlist
				</button>
				
				<button role="control" title="recursive remove special chars" class="btn btn-default trigger-modal" data-href="/tools/clean-rename-confirm/{{ directory~item.name|url_encode }}">
					Ãƒ <i class="fa fa-arrow-right"></i> A
				</button>
				<button role="control" data-href="/mpdctrl/update/{{ directory~item.name~''|url_encode }}" title="update mpd database" class="ajax-rqst btn btn-default">
					<i class="fa fa-refresh"></i>
				</button>
			</li>
			
	</div>
</div>

{% if hotlinks %}
	<h4>hotlinks</h4>
	{% for item in hotlinks %}
	<div class="row {{ cycle(['bg-col2','bg-col3'],loop.index) }} mouseover" id="track{{ loop.index }}">
		<div class="col-md-12">
			<a href="/filebrowser/{{ item }}" data-ajaxtarget="#main" class="ajax-link">
				<i class="fa fa-folder-open fa-lg"></i> {{ item }}</div>
			</a>
	</div>
	{% endfor %}
{% endif %}

{% if subDirectories %}
	<h4><i class="fa fa-folder-open fa-lg"></i> directories</h4>
	{% for item in subDirectories %}
	<a id="d{{ item.hash }}"/>
	<div class="row {{ cycle(['bg-col2','bg-col3'],loop.index) }} mouseover" id="track{{ loop.index }}">
		<div class="col-md-2">
			<button role="control" title="add this directory to playlist" class="btn btn-default player-ctrl" data-player='{"action":"addDirToPlaylist","mpdurl":"/mpdctrl/addSelect/{{ directory~item.name~''|url_encode }}"}'>
				<i class="fa fa-plus"></i>
			</button>
			
			<button role="control" data-href="/mpdctrl/update/{{ directory~item.name~''|url_encode }}" title="update mpd database" class="ajax-rqst btn btn-default">
				<i class="fa fa-refresh"></i>
			</button>
			
			
		</div>
		<div class="col-md-10">
			<a href="/filebrowser/{{ directory~item.name }}" data-ajaxtarget="#main" class="ajax-link">
				<i class="fa fa-folder-open fa-lg"></i> {{ item.name }}
			</a>
		</div>
	</div>
	{% endfor %}
{% endif %}

{% if files %}
	<h4>files</h4>
	
	{# music files #}
	{% for item in files %}
		{% if item.ext in musicfiles.ext %}
		<div class="row track-row {{ cycle(['bg-col2','bg-col3'],loop.index) }} mouseover track-{{ item.relativePathHash }}">
			<div class="col-md-2">
				{# TODO: if client is in mpd-mode give user a hint that he can only play mpd-imported tracks
			      its not that performant to update parent dir each time a song is played (/mpdctrl/updateMpdAndPlay/)...
			      for now playing files directly is only possible for already mpd-imported tracks ... 
			      playing files local is no issue and shoud work like a charm #}
				<button role="control" title="play" class="btn btn-default player-ctrl is-playbtn" data-player='{"action":"play","item":"{{ directory~item.name|url_encode }}","ext":"{{item.ext }}","hash":"{{ item.relativePathHash }}","mpdurl":"/mpdctrl/updateMpdAndPlay/{{ directory~item.name|url_encode }}"}'>
					<i class="fa fa-play fa-lg"></i>
				</button>
				<button role="control" data-href="/markup/widget-trackcontrol?item={{ directory }}{{ item.name }}" title="more" class="btn btn-default trigger-modal">
					<i class="fa fa-align-justify fa-lg"></i>
				</button>
				
				
				
			</div>
			<div class="col-md-10">
				<button role="control" title="play" class="btn btn-trnsp player-ctrl is-playbtn" data-player='{"action":"play","item":"{{ directory~item.name|url_encode }}","ext":"{{item.ext }}","hash":"{{ item.relativePathHash }}","mpdurl":"/mpdctrl/updateMpdAndPlay/{{ directory~item.name|url_encode }}"}'>
					<i class="fa fa-music fa-lg"></i>
				{{ item.name }}
				</button>
			</div>
			
		</div>
		
		{% endif %}
	{% endfor %}
	
	{# playlist files #}
	{% for item in files %}
		{% if item.ext in playlists.ext %}
		<div class="row {{ cycle(['bg-col2','bg-col3'],loop.index) }} mouseover track-{{ item.relativePathHash }}">
			<div class="col-md-2">
				<a href="/showplaylist/{{ directory~item.name }}" data-ajaxtarget="#main" class="ajax-link btn btn-default" title="show playlist">
					<i class="fa fa-eye fa-lg"></i>
				</a>
				
				<button role="control" title="add playlist to playlist" class="btn btn-default player-ctrl" data-player='{"action":"addPlaylistToPlaylist", "item": "{{ directory~item.name }}", "mpdurl":"/mpdctrl/addPlaylistToPlaylist/{{ directory~item.name }}"}'>
					<i class="fa fa-plus"></i>
				</button>
				
				<button role="control" title="replace current playlist with this playlist" class="btn btn-default player-ctrl" data-player='{"action":"replaceCurrentPlaylistKeepTrack", "item": "{{ directory~item.name }}", "mpdurl":"/mpdctrl/replaceCurrentPlaylistKeepTrack/{{ directory~item.name }}"}'>
					<i class="fa fa-refresh"></i>
				</button>
		
		
			</div>
			<div class="col-md-10">
			
				<a href="/showplaylist/{{ directory~item.name }}" data-ajaxtarget="#main" class="ajax-link">
				<i class="fa fa-list fa-lg"></i>
				{{ item.name }}</a>
			</div>
			
		</div>
		
		{% endif %}
	{% endfor %}
	
	{# info files #}
	{% for item in files %}
		{% if item.ext in infofiles.ext %}
		<div class="row {{ cycle(['bg-col2','bg-col3'],loop.index) }} mouseover track-{{ item.relativePathHash }}">
			<div class="col-md-2">
				<button role="control" data-href="/showplaintext/{{ directory }}{{ item.name }}" title="show filecontent" class="btn btn-default trigger-modal">
					<i class="fa fa-eye fa-lg"></i>
				</button>
			</div>
			<div class="col-md-10">
				<button role="control" data-href="/showplaintext/{{ directory }}{{ item.name }}" title="show filecontent" class="btn btn-trnsp trigger-modal">
				<i class="fa fa-info fa-lg"></i>
				{{ item.name }}</button>
			</div>
			
		</div>
		
		{% endif %}
	{% endfor %}
	
	{# images #}
	{# TODO: check why config.ini[images][ext] does not hold all image extensions!? maybe phpThump-issue? #}
	{% set imageext = ['png','jpg','jpeg','gif', 'bmp'] %}
	{% for item in files %}
		{% if item.ext in imageext %}
	<div class="row {{ cycle(['bg-col2','bg-col3'],loop.index) }} mouseover" id="image{{ loop.index }}">
		<div class="col-md-2">
			<a data-toggle="lightbox" href="/image-1000/path/{{ directory~item.name }}" data-type="image" data-gallery="galname" title="{{ item.name }}">
				<img src="/image-50/path/{{ directory~item.name }}" title="{{ item.name }}" alt="{{ item.name }}" />
			</a>
		</div>
		<div class="col-md-10">
			<i class="fa fa-image fa-lg"></i> {{ item.name }}
		</div>
	</div>
		{% endif %}
	{% endfor %}
	
	{% for item in files %}
		{% if item.ext  not in musicfiles.ext|merge(infofiles.ext)|merge(playlists.ext)|merge(imageext) %}
	<div class="row {{ cycle(['bg-col2','bg-col3'],loop.index) }} mouseover" id="track{{ loop.index }}">
		<div class="col-md-2"></div>
		<div class="col-md-10">
			<a href="/filebrowser/{{ directory~item.name }}" data-ajaxtarget="#main" class="ajax-link">
			<i class="fa fa-file fa-lg"></i> 
			{{ item.name }}</a>
		</div>
	</div>
	{% endif %}
	{% endfor %}
	
	
{% endif %}
